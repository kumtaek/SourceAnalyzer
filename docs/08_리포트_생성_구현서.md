# ë¦¬í¬íŠ¸ ìƒì„± êµ¬í˜„ì„œ

## ë¬¸ì„œ ì •ë³´
- **ì‘ì„±ì¼**: 2025-09-19
- **ë²„ì „**: v1.0
- **ëª©ì **: ë¶„ì„ ê²°ê³¼ë¥¼ ì‹œê°í™”í•œ ë‹¤ì–‘í•œ ë¦¬í¬íŠ¸ ìƒì„±

## ë¦¬í¬íŠ¸ ìƒì„± ê°œë°œ ì¼ì •

```mermaid
gantt
    title ë¦¬í¬íŠ¸ ìƒì„± ê¸°ëŠ¥ ê°œë°œ ì¼ì •
    dateFormat YYYY-MM-DD
    axisFormat %mì›”
    
    section ê¸°ë³¸ë¦¬í¬íŠ¸
    ê¸°ë³¸ë¦¬í¬íŠ¸êµ¬í˜„      :done, v10, 2025-01-01, 14d
    
    section ì•„í‚¤í…ì²˜ë¦¬í¬íŠ¸
    ë ˆì´ì–´ë³„ë¶„ë¥˜ê¸°ëŠ¥        :arch1, 2025-01-15, 10d
    ì‹œê°í™”ê°œì„               :arch2, 2025-01-25, 12d
    ì•„í‚¤í…ì²˜ë¦¬í¬íŠ¸ì™„ë£Œ      :milestone, arch_done, 2025-02-06, 0d
    
    section ERDë¦¬í¬íŠ¸
    ê¸°ë³¸ERDìƒì„±           :erd1, 2025-02-01, 8d
    ì¡°ì¸ê´€ê³„ì¶”ê°€           :erd2, 2025-02-09, 10d
    INFERREDí…Œì´ë¸”ì§€ì›    :erd3, 2025-02-19, 12d
    ERDë¦¬í¬íŠ¸ì™„ë£Œ         :milestone, erd_done, 2025-03-03, 0d
    
    section ì½œì²´ì¸ë¦¬í¬íŠ¸
    ê¸°ë³¸ì¶”ì ê¸°ëŠ¥          :call1, 2025-02-20, 10d
    Frontendì—°ê²°           :call2, 2025-03-02, 8d
    ì½œì²´ì¸ë¦¬í¬íŠ¸ì™„ë£Œ       :milestone, call_done, 2025-03-10, 0d
    
    section í†µí•©ë°ìµœì í™”
    í†µí•©ë¦¬í¬íŠ¸êµ¬í˜„         :integrate, 2025-03-11, 15d
    ë Œë”ë§ìµœì í™”           :perf1, 2025-03-26, 10d
    ëŒ€ìš©ëŸ‰ì²˜ë¦¬ê°œì„         :perf2, 2025-04-05, 12d
    ìµœì í™”ì™„ë£Œ         :milestone, v30, 2025-04-17, 0d
```

## 1. ë¦¬í¬íŠ¸ ìƒì„± ê°œìš”

### 1.1 ë¦¬í¬íŠ¸ ìƒì„± ëª©ì 
- ë©”íƒ€ë°ì´í„° ë¶„ì„ ê²°ê³¼ì˜ ì‹œê°ì  í‘œí˜„
- ì•„í‚¤í…ì²˜ êµ¬ì¡° íŒŒì•… ë° ë¬¸ì„œí™”
- ì˜í–¥í‰ê°€ ë° ì˜ì‚¬ê²°ì • ì§€ì›

### 1.2 ë¦¬í¬íŠ¸ ìœ í˜•

```mermaid
graph TD
    A["ë¦¬í¬íŠ¸ ìœ í˜•"] --> B["ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨"]
    A --> C["ERD ë¦¬í¬íŠ¸"]
    A --> D["ì½œì²´ì¸ ë¦¬í¬íŠ¸"]
    A --> E["ì˜í–¥í‰ê°€ ë¦¬í¬íŠ¸"]
    A --> F["ë©”íƒ€ë°ì´í„° ìš”ì•½ ë¦¬í¬íŠ¸"]
    
    B --> G["ë ˆì´ì–´ë³„ êµ¬ì¡°<br/>ì»´í¬ë„ŒíŠ¸ ë¶„í¬"]
    C --> H["í…Œì´ë¸” ê´€ê³„<br/>ì¡°ì¸ ì¡°ê±´"]
    D --> I["Frontendâ†’Backendâ†’DB<br/>í˜¸ì¶œ ê²½ë¡œ"]
    E --> J["ë³€ê²½ ì˜í–¥ ë²”ìœ„<br/>í…ŒìŠ¤íŠ¸ ëŒ€ìƒ"]
    F --> K["ì „ì²´ í†µê³„<br/>í’ˆì§ˆ ì§€í‘œ"]
    
    style A fill:#e3f2fd
    style G fill:#c8e6c9
    style H fill:#c8e6c9
    style I fill:#c8e6c9
    style J fill:#c8e6c9
    style K fill:#c8e6c9
```

## 2. ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±

### 2.1 ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ êµ¬ì¡°

```mermaid
flowchart TD
    subgraph "Frontend Layer"
        JSP["JSP Pages<br/>12ê°œ"]
        JSX["JSX Components<br/>8ê°œ"]
    end
    
    subgraph "API Entry Layer"
        API["REST APIs<br/>25ê°œ"]
    end
    
    subgraph "Business Layer"
        CTRL["Controllers<br/>15ê°œ"]
        SVC["Services<br/>18ê°œ"]
        REPO["Repositories<br/>12ê°œ"]
    end
    
    subgraph "Data Layer"
        QUERY["SQL Queries<br/>45ê°œ"]
        TABLE["Tables<br/>20ê°œ"]
    end
    
    JSP -->|CALL_API| API
    JSX -->|CALL_API| API
    API -->|CALL_METHOD| CTRL
    CTRL -->|CALL_METHOD| SVC
    SVC -->|CALL_METHOD| REPO
    REPO -->|CALL_QUERY| QUERY
    QUERY -->|USE_TABLE| TABLE
    
    style JSP fill:#e3f2fd
    style JSX fill:#e3f2fd
    style API fill:#fff3e0
    style CTRL fill:#fff3e0
    style SVC fill:#fff3e0
    style REPO fill:#fff3e0
    style QUERY fill:#e8f5e8
    style TABLE fill:#e8f5e8
```

### 2.2 ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±ê¸°

```python
class ArchitectureDiagramGenerator:
    """ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±ê¸°"""
    
    def __init__(self, project_id: int):
        self.project_id = project_id
        self.layer_stats = self.collect_layer_statistics()
        
    def generate_architecture_diagram(self, output_path: str) -> str:
        """ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ HTML ìƒì„±"""
        
        html_template = """
        <!DOCTYPE html>
        <html>
        <head>
            <title>ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ - {project_name}</title>
            <meta charset="utf-8">
            <script src="https://unpkg.com/cytoscape@3.21.0/dist/cytoscape.min.js"></script>
            <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
            <script src="https://unpkg.com/cytoscape-dagre@2.4.0/cytoscape-dagre.js"></script>
            <style>
                body {{ font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; }}
                .header {{ background: #2196F3; color: white; padding: 20px; border-radius: 5px; margin-bottom: 20px; }}
                .diagram-container {{ 
                    width: 100%; height: 600px; border: 1px solid #ddd; 
                    border-radius: 5px; margin-bottom: 20px;
                }}
                .stats-container {{ 
                    display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px;
                }}
                .stat-card {{ 
                    background: #f5f5f5; padding: 15px; border-radius: 5px; 
                    border-left: 4px solid #2196F3; min-width: 150px;
                }}
                .layer-legend {{ 
                    display: flex; gap: 15px; flex-wrap: wrap; padding: 15px; 
                    background: #f9f9f9; border-radius: 5px;
                }}
                .legend-item {{ 
                    display: flex; align-items: center; gap: 8px;
                }}
                .legend-color {{ 
                    width: 20px; height: 20px; border-radius: 3px;
                }}
            </style>
        </head>
        <body>
            <div class="header">
                <h1>ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨</h1>
                <p><strong>í”„ë¡œì íŠ¸:</strong> {project_name}</p>
                <p><strong>ìƒì„±ì¼ì‹œ:</strong> {generation_date}</p>
            </div>
            
            <div class="stats-container">
                {layer_stats_cards}
            </div>
            
            <div class="layer-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #e3f2fd;"></div>
                    <span>Frontend Layer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fff3e0;"></div>
                    <span>Business Layer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #e8f5e8;"></div>
                    <span>Data Layer</span>
                </div>
            </div>
            
            <div id="cy" class="diagram-container"></div>
            
            <script>
                const elements = {architecture_elements};
                
                const cy = cytoscape({{
                    container: document.getElementById('cy'),
                    elements: elements,
                    style: {architecture_styles},
                    layout: {{
                        name: 'dagre',
                        rankDir: 'TB',
                        spacingFactor: 1.5,
                        nodeSep: 100,
                        rankSep: 150
                    }}
                }});
                
                // ë…¸ë“œ í´ë¦­ ì´ë²¤íŠ¸
                cy.on('tap', 'node', function(evt) {{
                    const node = evt.target;
                    const data = node.data();
                    alert(`Layer: ${{data.layer}}\\nComponents: ${{data.count}}ê°œ\\nType: ${{data.componentType}}`);
                }});
            </script>
        </body>
        </html>
        """
        
        # í…œí”Œë¦¿ ë°ì´í„° ì¤€ë¹„
        template_data = self.prepare_architecture_template_data()
        
        # HTML ìƒì„±
        html_content = html_template.format(**template_data)
        
        # íŒŒì¼ ì €ì¥
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(html_content)
        
        return output_path
    
    def collect_layer_statistics(self) -> dict:
        """ë ˆì´ì–´ë³„ í†µê³„ ìˆ˜ì§‘"""
        
        query = """
        SELECT 
            layer,
            component_type,
            COUNT(*) as count
        FROM components 
        WHERE project_id = ? AND del_yn = 'N'
        GROUP BY layer, component_type
        ORDER BY layer, component_type
        """
        
        results = execute_query(query, [self.project_id])
        
        # ë ˆì´ì–´ë³„ í†µê³„ ì •ë¦¬
        layer_stats = {}
        for row in results:
            layer = row['layer']
            comp_type = row['component_type']
            count = row['count']
            
            if layer not in layer_stats:
                layer_stats[layer] = {}
            
            layer_stats[layer][comp_type] = count
        
        return layer_stats
```

## 3. ERD ë¦¬í¬íŠ¸ ìƒì„±

### 3.1 ERD êµ¬ì¡° ë¶„ì„

```mermaid
erDiagram
    CUSTOMERS {
        int customer_id PK
        string customer_name
        string email
        string phone
    }
    
    ORDERS {
        int order_id PK
        int customer_id FK
        datetime order_date
        decimal total_amount
    }
    
    ORDER_ITEMS {
        int item_id PK
        int order_id FK
        int product_id FK
        int quantity
        decimal price
    }
    
    PRODUCTS {
        int product_id PK
        string product_name
        int category_id FK
        decimal price
    }
    
    CATEGORIES {
        int category_id PK
        string category_name
        string description
    }
    
    CUSTOMERS ||--o{ ORDERS : "places"
    ORDERS ||--o{ ORDER_ITEMS : "contains"
    PRODUCTS ||--o{ ORDER_ITEMS : "ordered_as"
    CATEGORIES ||--o{ PRODUCTS : "categorizes"
```

### 3.2 ERD ìƒì„±ê¸° êµ¬í˜„

```python
class ERDGenerator:
    """ERD ë¦¬í¬íŠ¸ ìƒì„±ê¸°"""
    
    def __init__(self, project_id: int):
        self.project_id = project_id
        
    def generate_erd_report(self, output_path: str) -> str:
        """ERD HTML ë¦¬í¬íŠ¸ ìƒì„±"""
        
        # 1. í…Œì´ë¸” ì •ë³´ ìˆ˜ì§‘
        tables_data = self.collect_tables_data()
        
        # 2. ê´€ê³„ ì •ë³´ ìˆ˜ì§‘
        relationships_data = self.collect_table_relationships()
        
        # 3. Mermaid ERD ì½”ë“œ ìƒì„±
        mermaid_erd = self.generate_mermaid_erd(tables_data, relationships_data)
        
        # 4. HTML í…œí”Œë¦¿ ì ìš©
        html_content = self.create_erd_html(mermaid_erd, tables_data, relationships_data)
        
        # 5. íŒŒì¼ ì €ì¥
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(html_content)
        
        return output_path
    
    def collect_tables_data(self) -> List[dict]:
        """í…Œì´ë¸” ì •ë³´ ìˆ˜ì§‘"""
        
        query = """
        SELECT DISTINCT
            t.table_id,
            t.table_name,
            t.table_owner,
            t.table_comments,
            COUNT(c.column_id) as column_count,
            SUM(CASE WHEN c.position_pk IS NOT NULL THEN 1 ELSE 0 END) as pk_count
        FROM tables t
        LEFT JOIN columns c ON t.table_id = c.table_id AND c.del_yn = 'N'
        WHERE t.project_id = ? AND t.del_yn = 'N'
        GROUP BY t.table_id, t.table_name, t.table_owner, t.table_comments
        ORDER BY t.table_name
        """
        
        tables = execute_query(query, [self.project_id])
        
        # ê° í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ì •ë³´ ìˆ˜ì§‘
        for table in tables:
            table['columns'] = self.get_table_columns(table['table_id'])
        
        return tables
    
    def get_table_columns(self, table_id: int) -> List[dict]:
        """í…Œì´ë¸” ì»¬ëŸ¼ ì •ë³´ ì¡°íšŒ"""
        
        query = """
        SELECT 
            column_name,
            data_type,
            data_length,
            nullable,
            position_pk,
            column_comments
        FROM columns
        WHERE table_id = ? AND del_yn = 'N'
        ORDER BY 
            CASE WHEN position_pk IS NOT NULL THEN 0 ELSE 1 END,
            position_pk,
            column_name
        """
        
        return execute_query(query, [table_id])
    
    def generate_mermaid_erd(self, tables_data: List[dict], 
                           relationships_data: List[dict]) -> str:
        """Mermaid ERD ì½”ë“œ ìƒì„±"""
        
        erd_lines = ["erDiagram"]
        
        # 1. í…Œì´ë¸” ì •ì˜
        for table in tables_data:
            table_name = table['table_name']
            
            # í…Œì´ë¸” ì‹œì‘
            erd_lines.append(f"    {table_name} {{")
            
            # ì»¬ëŸ¼ ì •ì˜
            for column in table['columns']:
                col_name = column['column_name']
                data_type = self.normalize_data_type(column['data_type'])
                
                # PK í‘œì‹œ
                pk_suffix = " PK" if column['position_pk'] is not None else ""
                
                erd_lines.append(f"        {data_type} {col_name}{pk_suffix}")
            
            # í…Œì´ë¸” ì¢…ë£Œ
            erd_lines.append("    }")
            erd_lines.append("")
        
        # 2. ê´€ê³„ ì •ì˜
        for rel in relationships_data:
            src_table = rel['src_table']
            dst_table = rel['dst_table']
            relationship_type = self.determine_relationship_symbol(rel)
            join_column = rel['join_column']
            
            erd_lines.append(f"    {src_table} {relationship_type} {dst_table} : \"{join_column}\"")
        
        return "\n".join(erd_lines)
    
    def normalize_data_type(self, data_type: str) -> str:
        """ë°ì´í„° íƒ€ì… ì •ê·œí™” (Mermaid í˜¸í™˜)"""
        
        if not data_type or data_type == 'UNKNOWN':
            return "string"
        
        data_type_upper = data_type.upper()
        
        # ìˆ«ì íƒ€ì…
        if any(t in data_type_upper for t in ['INT', 'NUMBER', 'DECIMAL', 'FLOAT']):
            return "int"
        
        # ë‚ ì§œ íƒ€ì…
        if any(t in data_type_upper for t in ['DATE', 'TIME', 'TIMESTAMP']):
            return "datetime"
        
        # ê¸°ë³¸ì€ ë¬¸ìì—´
        return "string"
```

## 4. ì½œì²´ì¸ ë¦¬í¬íŠ¸ ìƒì„±

### 4.1 ì½œì²´ì¸ ì‹œê°í™” êµ¬ì¡°

```mermaid
sequenceDiagram
    participant U as User
    participant J as JSP<br/>userList.jsp
    participant A as API<br/>GET /api/users
    participant C as Controller<br/>UserController.getUsers()
    participant S as Service<br/>UserService.findAllUsers()
    participant R as Repository<br/>UserMapper.selectUsers()
    participant Q as Query<br/>SQL_SELECT
    participant T as Table<br/>USERS
    
    U->>J: í˜ì´ì§€ ìš”ì²­
    J->>A: AJAX í˜¸ì¶œ
    A->>C: HTTP ìš”ì²­
    C->>S: ë©”ì„œë“œ í˜¸ì¶œ
    S->>R: ë©”ì„œë“œ í˜¸ì¶œ
    R->>Q: ì¿¼ë¦¬ ì‹¤í–‰
    Q->>T: í…Œì´ë¸” ì ‘ê·¼
    T-->>Q: ë°ì´í„° ë°˜í™˜
    Q-->>R: ê²°ê³¼ ë°˜í™˜
    R-->>S: ê²°ê³¼ ë°˜í™˜
    S-->>C: ê²°ê³¼ ë°˜í™˜
    C-->>A: JSON ì‘ë‹µ
    A-->>J: ë°ì´í„° ìˆ˜ì‹ 
    J-->>U: í™”ë©´ í‘œì‹œ
```

### 4.2 ì½œì²´ì¸ ìƒì„±ê¸° êµ¬í˜„

```python
class CallChainGenerator:
    """ì½œì²´ì¸ ë¦¬í¬íŠ¸ ìƒì„±ê¸°"""
    
    def __init__(self, project_id: int):
        self.project_id = project_id
        
    def generate_call_chain_report(self, output_path: str) -> str:
        """ì½œì²´ì¸ HTML ë¦¬í¬íŠ¸ ìƒì„±"""
        
        # 1. ì™„ì „í•œ ì½œì²´ì¸ ìˆ˜ì§‘
        complete_chains = self.collect_complete_call_chains()
        
        # 2. ì£¼ìš” ì½œì²´ì¸ ì„ ë³„
        major_chains = self.select_major_call_chains(complete_chains)
        
        # 3. ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±
        sequence_diagrams = self.generate_sequence_diagrams(major_chains)
        
        # 4. HTML ë¦¬í¬íŠ¸ ìƒì„±
        html_content = self.create_call_chain_html(sequence_diagrams, complete_chains)
        
        # 5. íŒŒì¼ ì €ì¥
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(html_content)
        
        return output_path
    
    def collect_complete_call_chains(self) -> List[dict]:
        """ì™„ì „í•œ ì½œì²´ì¸ ìˆ˜ì§‘"""
        
        complete_chains = []
        
        # 1. Frontend ì‹œì‘ì  ì¡°íšŒ
        frontend_files = self.get_frontend_entry_points()
        
        for frontend in frontend_files:
            # 2. ê° Frontendì—ì„œ ì‹œì‘í•˜ëŠ” ì½œì²´ì¸ ì¶”ì 
            chains = self.trace_call_chain_from_frontend(frontend['file_id'])
            
            for chain in chains:
                if self.is_complete_chain(chain):
                    complete_chains.append({
                        'frontend_file': frontend['file_name'],
                        'chain_path': chain,
                        'chain_depth': len(chain),
                        'end_tables': self.extract_end_tables(chain)
                    })
        
        return complete_chains
    
    def trace_call_chain_from_frontend(self, frontend_file_id: int) -> List[List[dict]]:
        """Frontendì—ì„œ ì‹œì‘í•˜ëŠ” ì½œì²´ì¸ ì¶”ì """
        
        chains = []
        
        def trace_recursive(current_id: int, current_type: str, 
                          chain_path: List[dict], visited: set):
            
            # ë¬´í•œ ë£¨í”„ ë°©ì§€
            if current_id in visited or len(chain_path) > 10:
                return
            
            visited.add(current_id)
            
            # í˜„ì¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë‚˜ê°€ëŠ” ê´€ê³„ ì¡°íšŒ
            outgoing_relations = self.get_outgoing_relationships(current_id, current_type)
            
            if not outgoing_relations:
                # ì²´ì¸ ì¢…ë£Œ - ì™„ì „í•œ ì²´ì¸ì¸ì§€ í™•ì¸
                if len(chain_path) >= 3:  # ìµœì†Œ Frontend -> API -> Method
                    chains.append(chain_path.copy())
                return
            
            for relation in outgoing_relations:
                new_component = self.get_component_info(
                    relation['dst_id'], relation['dst_type']
                )
                
                new_path = chain_path + [new_component]
                new_visited = visited.copy()
                
                trace_recursive(
                    relation['dst_id'], 
                    relation['dst_type'], 
                    new_path, 
                    new_visited
                )
        
        # Frontend íŒŒì¼ì—ì„œ ì‹œì‘
        frontend_component = {'component_id': frontend_file_id, 'type': 'FILE'}
        trace_recursive(frontend_file_id, 'FILE', [frontend_component], set())
        
        return chains
    
    def generate_sequence_diagrams(self, major_chains: List[dict]) -> List[str]:
        """ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±"""
        
        sequence_diagrams = []
        
        for chain_info in major_chains:
            chain_path = chain_info['chain_path']
            
            # Mermaid ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±
            diagram_lines = ["sequenceDiagram"]
            
            # ì°¸ì—¬ì ì •ì˜
            participants = self.extract_participants(chain_path)
            for participant in participants:
                diagram_lines.append(f"    participant {participant['alias']} as {participant['name']}")
            
            diagram_lines.append("")
            
            # í˜¸ì¶œ ê´€ê³„ ì •ì˜
            for i in range(len(chain_path) - 1):
                current = chain_path[i]
                next_comp = chain_path[i + 1]
                
                current_alias = self.get_participant_alias(current)
                next_alias = self.get_participant_alias(next_comp)
                
                # í˜¸ì¶œ íƒ€ì…ì— ë”°ë¥¸ í™”ì‚´í‘œ ê²°ì •
                arrow_type = self.determine_arrow_type(current, next_comp)
                
                diagram_lines.append(
                    f"    {current_alias}{arrow_type}{next_alias}: {self.get_call_description(current, next_comp)}"
                )
            
            # ë°˜í™˜ ê´€ê³„ ì •ì˜ (ì—­ìˆœ)
            for i in range(len(chain_path) - 1, 0, -1):
                current = chain_path[i]
                prev_comp = chain_path[i - 1]
                
                current_alias = self.get_participant_alias(current)
                prev_alias = self.get_participant_alias(prev_comp)
                
                diagram_lines.append(f"    {current_alias}-->>+{prev_alias}: ê²°ê³¼ ë°˜í™˜")
            
            sequence_diagrams.append("\n".join(diagram_lines))
        
        return sequence_diagrams
```

## 5. í†µí•© ë¦¬í¬íŠ¸ ëŒ€ì‹œë³´ë“œ

### 5.1 ëŒ€ì‹œë³´ë“œ êµ¬ì¡°

```mermaid
graph TD
    A["í†µí•© ëŒ€ì‹œë³´ë“œ"] --> B["í”„ë¡œì íŠ¸ ê°œìš”"]
    A --> C["ì•„í‚¤í…ì²˜ ìš”ì•½"]
    A --> D["í’ˆì§ˆ ì§€í‘œ"]
    A --> E["ë¦¬í¬íŠ¸ ë§í¬"]
    
    B --> F["ì»´í¬ë„ŒíŠ¸ í†µê³„<br/>íŒŒì¼ í˜„í™©"]
    C --> G["ë ˆì´ì–´ë³„ ë¶„í¬<br/>ì˜ì¡´ì„± ë³µì¡ë„"]
    D --> H["ì½”ë“œ í’ˆì§ˆ<br/>ê´€ê³„ ë°€ë„"]
    E --> I["ìƒì„¸ ë¦¬í¬íŠ¸<br/>ë‹¤ìš´ë¡œë“œ ë§í¬"]
    
    style A fill:#e3f2fd
    style F fill:#c8e6c9
    style G fill:#c8e6c9
    style H fill:#c8e6c9
    style I fill:#c8e6c9
```

### 5.2 ëŒ€ì‹œë³´ë“œ ìƒì„±ê¸°

```python
class DashboardGenerator:
    """í†µí•© ëŒ€ì‹œë³´ë“œ ìƒì„±ê¸°"""
    
    def __init__(self, project_id: int):
        self.project_id = project_id
        self.project_info = self.get_project_info()
        
    def generate_dashboard(self, output_path: str) -> str:
        """í†µí•© ëŒ€ì‹œë³´ë“œ ìƒì„±"""
        
        # 1. ì „ì²´ í†µê³„ ìˆ˜ì§‘
        overall_stats = self.collect_overall_statistics()
        
        # 2. í’ˆì§ˆ ì§€í‘œ ê³„ì‚°
        quality_metrics = self.calculate_quality_metrics()
        
        # 3. ì°¨íŠ¸ ë°ì´í„° ì¤€ë¹„
        chart_data = self.prepare_chart_data()
        
        # 4. HTML ëŒ€ì‹œë³´ë“œ ìƒì„±
        html_content = self.create_dashboard_html(
            overall_stats, quality_metrics, chart_data
        )
        
        # 5. íŒŒì¼ ì €ì¥
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(html_content)
        
        return output_path
    
    def collect_overall_statistics(self) -> dict:
        """ì „ì²´ í†µê³„ ìˆ˜ì§‘"""
        
        stats = {}
        
        # íŒŒì¼ í†µê³„
        stats['files'] = self.get_file_statistics()
        
        # ì»´í¬ë„ŒíŠ¸ í†µê³„
        stats['components'] = self.get_component_statistics()
        
        # í…Œì´ë¸” í†µê³„
        stats['tables'] = self.get_table_statistics()
        
        # ê´€ê³„ í†µê³„
        stats['relationships'] = self.get_relationship_statistics()
        
        return stats
    
    def calculate_quality_metrics(self) -> dict:
        """í’ˆì§ˆ ì§€í‘œ ê³„ì‚°"""
        
        metrics = {}
        
        # 1. ì»´í¬ë„ŒíŠ¸ ë°€ë„ (íŒŒì¼ë‹¹ í‰ê·  ì»´í¬ë„ŒíŠ¸ ìˆ˜)
        metrics['component_density'] = self.calculate_component_density()
        
        # 2. ê´€ê³„ ë³µì¡ë„ (ì»´í¬ë„ŒíŠ¸ë‹¹ í‰ê·  ê´€ê³„ ìˆ˜)
        metrics['relationship_complexity'] = self.calculate_relationship_complexity()
        
        # 3. ë ˆì´ì–´ ë¶„ë¦¬ë„ (ë ˆì´ì–´ ê°„ ì˜ì¡´ì„± ë¹„ìœ¨)
        metrics['layer_separation'] = self.calculate_layer_separation()
        
        # 4. í…Œì´ë¸” í™œìš©ë„ (ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©ë˜ëŠ” í…Œì´ë¸” ë¹„ìœ¨)
        metrics['table_utilization'] = self.calculate_table_utilization()
        
        # 5. API ì»¤ë²„ë¦¬ì§€ (Frontendì—ì„œ í˜¸ì¶œë˜ëŠ” API ë¹„ìœ¨)
        metrics['api_coverage'] = self.calculate_api_coverage()
        
        return metrics
    
    def create_dashboard_html(self, overall_stats: dict, 
                            quality_metrics: dict, chart_data: dict) -> str:
        """ëŒ€ì‹œë³´ë“œ HTML ìƒì„±"""
        
        html_template = """
        <!DOCTYPE html>
        <html>
        <head>
            <title>SourceAnalyzer ëŒ€ì‹œë³´ë“œ - {project_name}</title>
            <meta charset="utf-8">
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <style>
                body {{ 
                    font-family: 'Malgun Gothic', sans-serif; 
                    margin: 0; padding: 20px; background: #f5f5f5; 
                }}
                .header {{ 
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white; padding: 30px; border-radius: 10px; 
                    margin-bottom: 30px; text-align: center;
                }}
                .dashboard-grid {{ 
                    display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 20px; margin-bottom: 30px;
                }}
                .card {{ 
                    background: white; padding: 20px; border-radius: 10px;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                }}
                .card h3 {{ 
                    margin: 0 0 15px 0; color: #333; 
                    border-bottom: 2px solid #667eea; padding-bottom: 10px;
                }}
                .stat-grid {{ 
                    display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;
                }}
                .stat-item {{ 
                    text-align: center; padding: 15px; 
                    background: #f8f9fa; border-radius: 8px;
                }}
                .stat-number {{ 
                    font-size: 2em; font-weight: bold; color: #667eea;
                }}
                .stat-label {{ 
                    font-size: 0.9em; color: #666; margin-top: 5px;
                }}
                .chart-container {{ 
                    position: relative; height: 300px; margin: 20px 0;
                }}
                .quality-meter {{ 
                    display: flex; align-items: center; margin: 10px 0;
                }}
                .meter-bar {{ 
                    flex: 1; height: 20px; background: #e0e0e0; 
                    border-radius: 10px; margin: 0 15px; position: relative;
                }}
                .meter-fill {{ 
                    height: 100%; border-radius: 10px;
                    background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #0abde3);
                }}
                .report-links {{ 
                    display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 15px;
                }}
                .report-link {{ 
                    display: block; padding: 15px; text-align: center;
                    background: #667eea; color: white; text-decoration: none;
                    border-radius: 8px; transition: background 0.3s;
                }}
                .report-link:hover {{ background: #5a6fd8; }}
            </style>
        </head>
        <body>
            <div class="header">
                <h1>ğŸ“Š SourceAnalyzer ëŒ€ì‹œë³´ë“œ</h1>
                <p><strong>í”„ë¡œì íŠ¸:</strong> {project_name}</p>
                <p><strong>ë¶„ì„ ì™„ë£Œì¼:</strong> {analysis_date}</p>
            </div>
            
            <div class="dashboard-grid">
                <!-- í”„ë¡œì íŠ¸ ê°œìš” -->
                <div class="card">
                    <h3>ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”</h3>
                    <div class="stat-grid">
                        <div class="stat-item">
                            <div class="stat-number">{total_files}</div>
                            <div class="stat-label">ì „ì²´ íŒŒì¼</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">{total_components}</div>
                            <div class="stat-label">ì „ì²´ ì»´í¬ë„ŒíŠ¸</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">{total_tables}</div>
                            <div class="stat-label">ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">{total_relationships}</div>
                            <div class="stat-label">ê´€ê³„</div>
                        </div>
                    </div>
                </div>
                
                <!-- ë ˆì´ì–´ë³„ ë¶„í¬ -->
                <div class="card">
                    <h3>ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë ˆì´ì–´</h3>
                    <div class="chart-container">
                        <canvas id="layerChart"></canvas>
                    </div>
                </div>
                
                <!-- í’ˆì§ˆ ì§€í‘œ -->
                <div class="card">
                    <h3>â­ í’ˆì§ˆ ì§€í‘œ</h3>
                    {quality_metrics_html}
                </div>
                
                <!-- íŒŒì¼ íƒ€ì…ë³„ ë¶„í¬ -->
                <div class="card">
                    <h3>ğŸ“ íŒŒì¼ íƒ€ì… ë¶„í¬</h3>
                    <div class="chart-container">
                        <canvas id="fileTypeChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- ìƒì„¸ ë¦¬í¬íŠ¸ ë§í¬ -->
            <div class="card">
                <h3>ğŸ“‘ ìƒì„¸ ë¦¬í¬íŠ¸</h3>
                <div class="report-links">
                    <a href="architecture_diagram.html" class="report-link">
                        ğŸ›ï¸ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
                    </a>
                    <a href="erd_report.html" class="report-link">
                        ğŸ—ƒï¸ ERD ë¦¬í¬íŠ¸
                    </a>
                    <a href="call_chain_report.html" class="report-link">
                        ğŸ”— ì½œì²´ì¸ ë¦¬í¬íŠ¸
                    </a>
                    <a href="impact_analysis.html" class="report-link">
                        ğŸ“Š ì˜í–¥í‰ê°€ ë„êµ¬
                    </a>
                </div>
            </div>
            
            <script>
                // ë ˆì´ì–´ ì°¨íŠ¸
                const layerCtx = document.getElementById('layerChart').getContext('2d');
                new Chart(layerCtx, {{
                    type: 'doughnut',
                    data: {layer_chart_data},
                    options: {{
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {{
                            legend: {{
                                position: 'bottom'
                            }}
                        }}
                    }}
                }});
                
                // íŒŒì¼ íƒ€ì… ì°¨íŠ¸
                const fileTypeCtx = document.getElementById('fileTypeChart').getContext('2d');
                new Chart(fileTypeCtx, {{
                    type: 'bar',
                    data: {file_type_chart_data},
                    options: {{
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {{
                            y: {{
                                beginAtZero: true
                            }}
                        }}
                    }}
                }});
            </script>
        </body>
        </html>
        """
        
        # í…œí”Œë¦¿ ë°ì´í„° ì¤€ë¹„
        template_data = self.prepare_dashboard_template_data(
            overall_stats, quality_metrics, chart_data
        )
        
        return html_template.format(**template_data)
```

## 6. ë¦¬í¬íŠ¸ ìë™í™” ë° ìŠ¤ì¼€ì¤„ë§

### 6.1 ë¦¬í¬íŠ¸ ìƒì„± íŒŒì´í”„ë¼ì¸

```mermaid
flowchart TD
    A["ë¦¬í¬íŠ¸ ìƒì„± ìš”ì²­"] --> B["ë©”íƒ€ë°ì´í„° ê²€ì¦"]
    B --> C["ë¦¬í¬íŠ¸ íƒ€ì… ê²°ì •"]
    C --> D["ë°ì´í„° ìˆ˜ì§‘"]
    D --> E["ë¦¬í¬íŠ¸ ìƒì„±"]
    E --> F["í’ˆì§ˆ ê²€ì‚¬"]
    F --> G["íŒŒì¼ ì €ì¥"]
    G --> H["ì•Œë¦¼ ë°œì†¡"]
    
    style A fill:#e3f2fd
    style H fill:#c8e6c9
```

### 6.2 ìë™í™” ìŠ¤í¬ë¦½íŠ¸

```python
class ReportAutomationManager:
    """ë¦¬í¬íŠ¸ ìë™í™” ê´€ë¦¬ì"""
    
    def __init__(self):
        self.generators = {
            'architecture': ArchitectureDiagramGenerator,
            'erd': ERDGenerator,
            'callchain': CallChainGenerator,
            'dashboard': DashboardGenerator
        }
    
    def generate_all_reports(self, project_id: int, output_dir: str) -> dict:
        """ëª¨ë“  ë¦¬í¬íŠ¸ ìƒì„±"""
        
        results = {
            'success': [],
            'failed': [],
            'total_time': 0
        }
        
        start_time = time.time()
        
        try:
            # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
            os.makedirs(output_dir, exist_ok=True)
            
            # ê° ë¦¬í¬íŠ¸ ìƒì„±
            for report_type, generator_class in self.generators.items():
                try:
                    generator = generator_class(project_id)
                    output_path = os.path.join(output_dir, f"{report_type}_report.html")
                    
                    # ë¦¬í¬íŠ¸ ìƒì„±
                    result_path = generator.generate_report(output_path)
                    
                    results['success'].append({
                        'type': report_type,
                        'path': result_path,
                        'size': os.path.getsize(result_path)
                    })
                    
                except Exception as e:
                    results['failed'].append({
                        'type': report_type,
                        'error': str(e)
                    })
            
            results['total_time'] = time.time() - start_time
            
            # ì„±ê³µ ì‹œ ëŒ€ì‹œë³´ë“œ ìƒì„±
            if results['success']:
                dashboard_generator = DashboardGenerator(project_id)
                dashboard_path = os.path.join(output_dir, "index.html")
                dashboard_generator.generate_dashboard(dashboard_path)
                
                results['dashboard_path'] = dashboard_path
            
        except Exception as e:
            results['fatal_error'] = str(e)
        
        return results
    
    def schedule_report_generation(self, project_id: int, schedule: str):
        """ë¦¬í¬íŠ¸ ìƒì„± ìŠ¤ì¼€ì¤„ë§"""
        
        # í¬ë¡  ìŠ¤ì¼€ì¤„ í˜•íƒœë¡œ ë¦¬í¬íŠ¸ ìë™ ìƒì„± ì„¤ì •
        # ì˜ˆ: "0 2 * * *" (ë§¤ì¼ ìƒˆë²½ 2ì‹œ)
        
        import schedule
        
        def job():
            output_dir = f"./reports/{project_id}/{datetime.now().strftime('%Y%m%d_%H%M%S')}"
            self.generate_all_reports(project_id, output_dir)
        
        schedule.every().day.at("02:00").do(job)
```

---

## ë‹¤ìŒ ë‹¨ê³„
- [10_ì„±ëŠ¥_ìµœì í™”_ê°€ì´ë“œ.md](10_ì„±ëŠ¥_ìµœì í™”_ê°€ì´ë“œ.md): ì‹œìŠ¤í…œ ì„±ëŠ¥ ìµœì í™” ë°©ì•ˆ
