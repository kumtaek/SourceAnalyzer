<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SourceAnalyzer - ì˜í–¥ë„ ë¶„ì„ ë¦¬í¬íŠ¸</title>
    <script src="https://unpkg.com/cytoscape@3.21.0/dist/cytoscape.min.js"></script>
    <script src="https://unpkg.com/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://unpkg.com/cytoscape-dagre@2.4.0/cytoscape-dagre.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .header { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .analysis-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .impact-network { height: 500px; border: 2px solid #ddd; border-radius: 10px; margin: 20px 0; }
        .impact-level { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .level-1 { background: #ffebee; border-left: 4px solid #f44336; }
        .level-2 { background: #fff3e0; border-left: 4px solid #ff9800; }
        .level-3 { background: #e8f5e8; border-left: 4px solid #4caf50; }
        .component-list { max-height: 300px; overflow-y: auto; }
        .component-item { padding: 8px; margin: 5px 0; background: #f8f9fa; border-radius: 3px; display: flex; justify-content: space-between; }
        .risk-high { border-left: 4px solid #f44336; }
        .risk-medium { border-left: 4px solid #ff9800; }
        .risk-low { border-left: 4px solid #4caf50; }
        .change-scenario { background: #e3f2fd; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .action-item { background: #fff3e0; padding: 10px; margin: 5px 0; border-radius: 3px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¯ ì˜í–¥ë„ ë¶„ì„ ë¦¬í¬íŠ¸</h1>
        <p>ë³€ê²½ ì‹œë‚˜ë¦¬ì˜¤: <strong>USERS í…Œì´ë¸”ì˜ USERNAME ì»¬ëŸ¼ VARCHAR2(50) â†’ VARCHAR2(100) ë³€ê²½</strong></p>
        <p>ë¶„ì„ ì¼ì‹œ: 2025-09-20 14:30:25</p>
    </div>

    <div class="analysis-container">
        <div class="card">
            <h3>ğŸ“‹ ì˜í–¥ë„ ìš”ì•½</h3>
            
            <div class="impact-level level-1">
                <h4>ğŸš¨ ì§ì ‘ ì˜í–¥ (Level 1)</h4>
                <p><strong>15ê°œ ì»´í¬ë„ŒíŠ¸</strong>ê°€ ì¦‰ì‹œ ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤</p>
                <ul>
                    <li>SQL ì¿¼ë¦¬: 8ê°œ</li>
                    <li>Java ë©”ì„œë“œ: 5ê°œ</li>
                    <li>JSP í˜ì´ì§€: 2ê°œ</li>
                </ul>
            </div>

            <div class="impact-level level-2">
                <h4>âš ï¸ ê°„ì ‘ ì˜í–¥ (Level 2)</h4>
                <p><strong>23ê°œ ì»´í¬ë„ŒíŠ¸</strong>ê°€ ê°„ì ‘ì ìœ¼ë¡œ ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤</p>
                <ul>
                    <li>Service í´ë˜ìŠ¤: 6ê°œ</li>
                    <li>Controller í´ë˜ìŠ¤: 4ê°œ</li>
                    <li>DTO í´ë˜ìŠ¤: 8ê°œ</li>
                    <li>JSP í™”ë©´: 5ê°œ</li>
                </ul>
            </div>

            <div class="impact-level level-3">
                <h4>â„¹ï¸ ì—°ì‡„ ì˜í–¥ (Level 3)</h4>
                <p><strong>12ê°œ ì»´í¬ë„ŒíŠ¸</strong>ê°€ ì—°ì‡„ì ìœ¼ë¡œ ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                <ul>
                    <li>Frontend ì»´í¬ë„ŒíŠ¸: 7ê°œ</li>
                    <li>API ì—”ë“œí¬ì¸íŠ¸: 3ê°œ</li>
                    <li>ê¸°íƒ€ ê´€ë ¨ í…Œì´ë¸”: 2ê°œ</li>
                </ul>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ¯ í•µì‹¬ ì˜í–¥ ì»´í¬ë„ŒíŠ¸</h3>
            
            <div class="component-list">
                <div class="component-item risk-high">
                    <span><strong>UserMapper.xml</strong> - selectUserByUsername</span>
                    <span>ğŸš¨ ë†’ìŒ</span>
                </div>
                <div class="component-item risk-high">
                    <span><strong>UserDao.java</strong> - findByUsername()</span>
                    <span>ğŸš¨ ë†’ìŒ</span>
                </div>
                <div class="component-item risk-high">
                    <span><strong>LoginService.java</strong> - authenticateUser()</span>
                    <span>ğŸš¨ ë†’ìŒ</span>
                </div>
                <div class="component-item risk-medium">
                    <span><strong>UserController.java</strong> - login()</span>
                    <span>âš ï¸ ì¤‘ê°„</span>
                </div>
                <div class="component-item risk-medium">
                    <span><strong>userList.jsp</strong> - ì‚¬ìš©ì ëª©ë¡ í™”ë©´</span>
                    <span>âš ï¸ ì¤‘ê°„</span>
                </div>
                <div class="component-item risk-medium">
                    <span><strong>UserDto.java</strong> - username í•„ë“œ</span>
                    <span>âš ï¸ ì¤‘ê°„</span>
                </div>
                <div class="component-item risk-low">
                    <span><strong>UserSearchService.java</strong> - searchUsers()</span>
                    <span>âœ… ë‚®ìŒ</span>
                </div>
                <div class="component-item risk-low">
                    <span><strong>/api/user/search</strong> - API</span>
                    <span>âœ… ë‚®ìŒ</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card">
        <h3>ğŸ”— ì˜í–¥ ì „íŒŒ ë„¤íŠ¸ì›Œí¬</h3>
        <div id="impactNetwork" class="impact-network"></div>
    </div>

    <div class="card">
        <h3>ğŸ“ ë³€ê²½ ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¶„ì„</h3>
        
        <div class="change-scenario">
            <h4>ì‹œë‚˜ë¦¬ì˜¤ 1: ì»¬ëŸ¼ í¬ê¸° í™•ì¥ (VARCHAR2 50â†’100)</h4>
            <p><strong>ì˜í–¥ë„: ì¤‘ê°„</strong> | ì˜ˆìƒ ì‘ì—… ì‹œê°„: 2-3ì‹œê°„</p>
            
            <div class="action-item">
                <strong>í•„ìˆ˜ ì‘ì—…:</strong>
                <ul>
                    <li>UserMapper.xmlì˜ resultMap ê²€í† </li>
                    <li>UserDto.javaì˜ validation ê·œì¹™ ìˆ˜ì •</li>
                    <li>Frontend ì…ë ¥ í•„ë“œ maxlength ìˆ˜ì •</li>
                </ul>
            </div>
            
            <div class="action-item">
                <strong>í…ŒìŠ¤íŠ¸ ëŒ€ìƒ:</strong>
                <ul>
                    <li>ë¡œê·¸ì¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</li>
                    <li>ì‚¬ìš©ì ë“±ë¡ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</li>
                    <li>ì‚¬ìš©ì ê²€ìƒ‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</li>
                </ul>
            </div>
        </div>

        <div class="change-scenario">
            <h4>ì‹œë‚˜ë¦¬ì˜¤ 2: ì»¬ëŸ¼ ì‚­ì œ</h4>
            <p><strong>ì˜í–¥ë„: ë†’ìŒ</strong> | ì˜ˆìƒ ì‘ì—… ì‹œê°„: 1-2ì¼</p>
            
            <div class="action-item">
                <strong>âš ï¸ ìœ„í—˜ ìš”ì†Œ:</strong>
                <ul>
                    <li>15ê°œ SQL ì¿¼ë¦¬ì—ì„œ í•´ë‹¹ ì»¬ëŸ¼ ì°¸ì¡°</li>
                    <li>5ê°œ Java í´ë˜ìŠ¤ì—ì„œ ì§ì ‘ ì‚¬ìš©</li>
                    <li>2ê°œ JSPì—ì„œ í™”ë©´ í‘œì‹œ</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Cytoscape.jsë¡œ ì˜í–¥ ì „íŒŒ ë„¤íŠ¸ì›Œí¬ ì‹œê°í™”
        const cy = cytoscape({
            container: document.getElementById('impactNetwork'),
            
            elements: [
                // ë…¸ë“œë“¤
                { data: { id: 'users_table', label: 'USERS í…Œì´ë¸”', type: 'table' } },
                { data: { id: 'user_mapper', label: 'UserMapper.xml', type: 'xml' } },
                { data: { id: 'user_dao', label: 'UserDao.java', type: 'java' } },
                { data: { id: 'user_service', label: 'UserService.java', type: 'java' } },
                { data: { id: 'user_controller', label: 'UserController.java', type: 'java' } },
                { data: { id: 'login_jsp', label: 'login.jsp', type: 'jsp' } },
                { data: { id: 'user_list_jsp', label: 'userList.jsp', type: 'jsp' } },
                { data: { id: 'api_login', label: '/api/user/login', type: 'api' } },
                
                // ê´€ê³„ë“¤ (ì˜í–¥ ì „íŒŒ ë°©í–¥)
                { data: { source: 'users_table', target: 'user_mapper', impact: 'direct' } },
                { data: { source: 'user_mapper', target: 'user_dao', impact: 'direct' } },
                { data: { source: 'user_dao', target: 'user_service', impact: 'direct' } },
                { data: { source: 'user_service', target: 'user_controller', impact: 'indirect' } },
                { data: { source: 'user_controller', target: 'api_login', impact: 'indirect' } },
                { data: { source: 'api_login', target: 'login_jsp', impact: 'chain' } },
                { data: { source: 'user_service', target: 'user_list_jsp', impact: 'indirect' } }
            ],
            
            style: [
                {
                    selector: 'node',
                    style: {
                        'label': 'data(label)',
                        'text-valign': 'center',
                        'color': 'white',
                        'font-size': '12px',
                        'width': '120px',
                        'height': '40px',
                        'shape': 'roundrectangle'
                    }
                },
                {
                    selector: 'node[type="table"]',
                    style: { 'background-color': '#f44336' }
                },
                {
                    selector: 'node[type="xml"]',
                    style: { 'background-color': '#ff9800' }
                },
                {
                    selector: 'node[type="java"]',
                    style: { 'background-color': '#2196f3' }
                },
                {
                    selector: 'node[type="jsp"]',
                    style: { 'background-color': '#4caf50' }
                },
                {
                    selector: 'node[type="api"]',
                    style: { 'background-color': '#9c27b0' }
                },
                {
                    selector: 'edge[impact="direct"]',
                    style: {
                        'line-color': '#f44336',
                        'target-arrow-color': '#f44336',
                        'target-arrow-shape': 'triangle',
                        'width': 3
                    }
                },
                {
                    selector: 'edge[impact="indirect"]',
                    style: {
                        'line-color': '#ff9800',
                        'target-arrow-color': '#ff9800',
                        'target-arrow-shape': 'triangle',
                        'width': 2
                    }
                },
                {
                    selector: 'edge[impact="chain"]',
                    style: {
                        'line-color': '#4caf50',
                        'target-arrow-color': '#4caf50',
                        'target-arrow-shape': 'triangle',
                        'width': 1,
                        'line-style': 'dashed'
                    }
                }
            ],
            
            layout: {
                name: 'dagre',
                rankDir: 'TB',
                spacingFactor: 1.5
            }
        });
    </script>
</body>
</html>
