<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SourceAnalyzer - API 사용 현황</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .header { background: linear-gradient(135deg, #00b4db 0%, #0083b0 100%); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .full-width { grid-column: 1 / -1; }
        .chart-container { height: 300px; position: relative; }
        .api-network { height: 400px; border: 2px solid #ddd; border-radius: 8px; }
        .api-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .api-table th, .api-table td { padding: 10px; border: 1px solid #ddd; text-align: left; }
        .api-table th { background: #f1f3f4; font-weight: bold; }
        .status-active { color: #28a745; font-weight: bold; }
        .status-unused { color: #dc3545; font-weight: bold; }
        .status-deprecated { color: #ffc107; font-weight: bold; }
        .usage-high { background: #ffebee; }
        .usage-medium { background: #fff3e0; }
        .usage-low { background: #f3e5f5; }
        .method-get { background: #e8f5e8; }
        .method-post { background: #e3f2fd; }
        .method-put { background: #fff3e0; }
        .method-delete { background: #ffebee; }
    </style>
</head>
<body>
    <div class="header">
        <h1>🌐 API 사용 현황 분석</h1>
        <p>Frontend-Backend API 호출 패턴 및 사용률 분석 | 분석 대상: SampleSrc</p>
    </div>

    <div class="dashboard">
        <div class="card">
            <h3>📊 API 메서드별 분포</h3>
            <div class="chart-container">
                <canvas id="apiMethodChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h3>📈 API 사용 빈도</h3>
            <div class="chart-container">
                <canvas id="apiUsageChart"></canvas>
            </div>
        </div>

        <div class="card full-width">
            <h3>🔗 Frontend-Backend API 연결 네트워크</h3>
            <div id="apiNetwork" class="api-network">
                <svg width="100%" height="400" style="background: #fafafa;">
                    <!-- Frontend 노드들 -->
                    <g transform="translate(50, 50)">
                        <rect x="0" y="0" width="100" height="30" rx="5" fill="#ff6b6b"/>
                        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">login.jsp</text>
                    </g>
                    <g transform="translate(50, 100)">
                        <rect x="0" y="0" width="100" height="30" rx="5" fill="#ff6b6b"/>
                        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">userList.jsp</text>
                    </g>
                    <g transform="translate(50, 150)">
                        <rect x="0" y="0" width="100" height="30" rx="5" fill="#ff6b6b"/>
                        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">UserManagement.jsx</text>
                    </g>
                    
                    <!-- API 노드들 -->
                    <g transform="translate(250, 75)">
                        <rect x="0" y="0" width="120" height="30" rx="5" fill="#4ecdc4"/>
                        <text x="60" y="20" text-anchor="middle" fill="white" font-size="10">/api/user/login</text>
                    </g>
                    <g transform="translate(250, 125)">
                        <rect x="0" y="0" width="120" height="30" rx="5" fill="#4ecdc4"/>
                        <text x="60" y="20" text-anchor="middle" fill="white" font-size="10">/api/user/list</text>
                    </g>
                    
                    <!-- Backend 노드들 -->
                    <g transform="translate(450, 100)">
                        <rect x="0" y="0" width="100" height="30" rx="5" fill="#45b7d1"/>
                        <text x="50" y="20" text-anchor="middle" fill="white" font-size="10">UserController</text>
                    </g>
                    
                    <!-- 연결선들 -->
                    <line x1="150" y1="65" x2="250" y2="90" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
                    <line x1="150" y1="115" x2="250" y2="140" stroke="#95a5a6" stroke-width="2" marker-end="url(#arrow)"/>
                    <line x1="150" y1="165" x2="250" y2="140" stroke="#95a5a6" stroke-width="1" marker-end="url(#arrow)"/>
                    <line x1="370" y1="90" x2="450" y2="115" stroke="#34495e" stroke-width="3" marker-end="url(#arrow)"/>
                    <line x1="370" y1="140" x2="450" y2="115" stroke="#34495e" stroke-width="3" marker-end="url(#arrow)"/>
                    
                    <!-- 호출 빈도 표시 -->
                    <text x="200" y="75" text-anchor="middle" fill="#e74c3c" font-size="12" font-weight="bold">15회</text>
                    <text x="200" y="125" text-anchor="middle" fill="#e74c3c" font-size="12" font-weight="bold">12회</text>
                    <text x="200" y="155" text-anchor="middle" fill="#f39c12" font-size="10">8회</text>
                    
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#34495e"/>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>

        <div class="card full-width">
            <h3>📋 API 엔드포인트 상세 현황</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>API 엔드포인트</th>
                        <th>HTTP 메서드</th>
                        <th>호출 빈도</th>
                        <th>Frontend 연결</th>
                        <th>Backend 처리</th>
                        <th>상태</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="usage-high">
                        <td><strong>/api/user/login</strong></td>
                        <td><span class="method-post">POST</span></td>
                        <td>15회</td>
                        <td>login.jsp, UserManagement.jsx</td>
                        <td>UserController.login()</td>
                        <td><span class="status-active">활성</span></td>
                    </tr>
                    <tr class="usage-high">
                        <td><strong>/api/user/list</strong></td>
                        <td><span class="method-get">GET</span></td>
                        <td>12회</td>
                        <td>userList.jsp, UserManagement.jsx</td>
                        <td>UserController.getUserList()</td>
                        <td><span class="status-active">활성</span></td>
                    </tr>
                    <tr class="usage-medium">
                        <td><strong>/api/product/search</strong></td>
                        <td><span class="method-get">GET</span></td>
                        <td>8회</td>
                        <td>productList.jsp, ProductDashboard.jsx</td>
                        <td>ProductController.searchProducts()</td>
                        <td><span class="status-active">활성</span></td>
                    </tr>
                    <tr class="usage-medium">
                        <td><strong>/api/order/create</strong></td>
                        <td><span class="method-post">POST</span></td>
                        <td>6회</td>
                        <td>orderForm.jsp</td>
                        <td>OrderController.createOrder()</td>
                        <td><span class="status-active">활성</span></td>
                    </tr>
                    <tr class="usage-low">
                        <td><strong>/api/product/category</strong></td>
                        <td><span class="method-get">GET</span></td>
                        <td>3회</td>
                        <td>productList.jsp</td>
                        <td>ProductController.getCategories()</td>
                        <td><span class="status-active">활성</span></td>
                    </tr>
                    <tr class="usage-low">
                        <td><strong>/api/user/profile</strong></td>
                        <td><span class="method-get">GET</span></td>
                        <td>2회</td>
                        <td>UserManagement.jsx</td>
                        <td>UserController.getProfile()</td>
                        <td><span class="status-deprecated">저사용</span></td>
                    </tr>
                    <tr style="background: #fff3cd;">
                        <td><strong>/api/admin/settings</strong></td>
                        <td><span class="method-get">GET</span></td>
                        <td>0회</td>
                        <td>없음</td>
                        <td>AdminController.getSettings()</td>
                        <td><span class="status-unused">미사용</span></td>
                    </tr>
                    <tr style="background: #fff3cd;">
                        <td><strong>/api/report/export</strong></td>
                        <td><span class="method-post">POST</span></td>
                        <td>0회</td>
                        <td>없음</td>
                        <td>ReportController.exportData()</td>
                        <td><span class="status-unused">미사용</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // API 메서드별 분포 차트
        const methodCtx = document.getElementById('apiMethodChart').getContext('2d');
        new Chart(methodCtx, {
            type: 'pie',
            data: {
                labels: ['GET', 'POST', 'PUT', 'DELETE'],
                datasets: [{
                    data: [16, 8, 3, 1],
                    backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#F44336']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        // API 사용 빈도 차트
        const usageCtx = document.getElementById('apiUsageChart').getContext('2d');
        new Chart(usageCtx, {
            type: 'bar',
            data: {
                labels: ['높은 사용빈도', '중간 사용빈도', '낮은 사용빈도', '미사용'],
                datasets: [{
                    label: 'API 개수',
                    data: [8, 12, 6, 2],
                    backgroundColor: ['#F44336', '#FF9800', '#4CAF50', '#9E9E9E']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                }
            }
        });

        // 간단한 알림 기능으로 대체
        console.log('API 네트워크 다이어그램이 표시됩니다.');
    </script>
</body>
</html>
