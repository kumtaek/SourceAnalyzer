<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SourceAnalyzer - ì½”ë“œ í’ˆì§ˆ ë¶„ì„</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .header { background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .quality-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .chart-container { height: 250px; position: relative; }
        .heatmap-container { height: 400px; border: 1px solid #ddd; border-radius: 5px; overflow: hidden; }
        .quality-score { text-align: center; padding: 20px; }
        .score-circle { width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2em; font-weight: bold; color: white; }
        .score-excellent { background: linear-gradient(135deg, #00b894, #00cec9); }
        .score-good { background: linear-gradient(135deg, #fdcb6e, #e17055); }
        .score-poor { background: linear-gradient(135deg, #fd79a8, #e84393); }
        .issue-list { max-height: 300px; overflow-y: auto; }
        .issue-item { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .issue-critical { background: #ffebee; border-left: 4px solid #f44336; }
        .issue-warning { background: #fff3e0; border-left: 4px solid #ff9800; }
        .issue-info { background: #e8f5e8; border-left: 4px solid #4caf50; }
        .complexity-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .complexity-table th, .complexity-table td { padding: 8px 12px; border: 1px solid #ddd; text-align: left; }
        .complexity-table th { background: #f1f3f4; }
        .complexity-high { background: #ffcdd2; }
        .complexity-medium { background: #fff3e0; }
        .complexity-low { background: #c8e6c9; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“Š ì½”ë“œ í’ˆì§ˆ ë¶„ì„</h1>
        <p>ì½”ë“œ ë³µì¡ë„, ì—ëŸ¬ìœ¨, ìœ ì§€ë³´ìˆ˜ì„± ì¢…í•© ë¶„ì„ | SampleSrc í”„ë¡œì íŠ¸</p>
    </div>

    <div class="quality-grid">
        <div class="card">
            <h3>ğŸ¯ ì „ì²´ í’ˆì§ˆ ì ìˆ˜</h3>
            <div class="quality-score">
                <div class="score-circle score-good">78</div>
                <div><strong>ì–‘í˜¸</strong> (100ì  ë§Œì )</div>
                <p>í‰ê·  ì´ìƒì˜ ì½”ë“œ í’ˆì§ˆì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“ˆ í’ˆì§ˆ ì§€í‘œ ë¶„í¬</h3>
            <div class="chart-container">
                <canvas id="qualityChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ”¥ ë³µì¡ë„ íˆíŠ¸ë§µ</h3>
            <div id="complexityHeatmap" class="heatmap-container"></div>
        </div>

        <div class="card">
            <h3>âš ï¸ í’ˆì§ˆ ì´ìŠˆ</h3>
            <div class="issue-list">
                <div class="issue-item issue-critical">
                    <strong>ğŸš¨ ì‹¬ê°</strong>: ComplexQueryMapper.xml - 150ì¤„ ì´ˆê³¼ ë³µì¡ ì¿¼ë¦¬
                </div>
                <div class="issue-item issue-critical">
                    <strong>ğŸš¨ ì‹¬ê°</strong>: OrderService.processComplexOrder() - ìˆœí™˜ ë³µì¡ë„ 15
                </div>
                <div class="issue-item issue-warning">
                    <strong>âš ï¸ ê²½ê³ </strong>: UserController - ë©”ì„œë“œ ìˆ˜ ê³¼ë‹¤ (18ê°œ)
                </div>
                <div class="issue-item issue-warning">
                    <strong>âš ï¸ ê²½ê³ </strong>: ProductService - ì¤‘ë³µ ì½”ë“œ ë°œê²¬ (3ê³³)
                </div>
                <div class="issue-item issue-info">
                    <strong>â„¹ï¸ ì •ë³´</strong>: CategoryDao - ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë©”ì„œë“œ 2ê°œ
                </div>
                <div class="issue-item issue-info">
                    <strong>â„¹ï¸ ì •ë³´</strong>: AUDIT_LOG í…Œì´ë¸” - ì°¸ì¡° ì—†ìŒ (ê³ ì•„ í…Œì´ë¸”)
                </div>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“Š íŒŒì¼ë³„ ë³µì¡ë„ ë¶„ì„</h3>
            <div class="chart-container">
                <canvas id="complexityChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“‹ ìƒì„¸ ë³µì¡ë„ ë¦¬í¬íŠ¸</h3>
            <table class="complexity-table">
                <thead>
                    <tr>
                        <th>íŒŒì¼ëª…</th>
                        <th>ë¼ì¸ ìˆ˜</th>
                        <th>ë©”ì„œë“œ ìˆ˜</th>
                        <th>ë³µì¡ë„</th>
                        <th>ì—ëŸ¬ ìˆ˜</th>
                        <th>ë“±ê¸‰</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="complexity-high">
                        <td><strong>ComplexQueryMapper.xml</strong></td>
                        <td>245ì¤„</td>
                        <td>12ê°œ ì¿¼ë¦¬</td>
                        <td>9.2</td>
                        <td>2ê°œ</td>
                        <td>ğŸ”´ ë†’ìŒ</td>
                    </tr>
                    <tr class="complexity-high">
                        <td><strong>OrderService.java</strong></td>
                        <td>180ì¤„</td>
                        <td>8ê°œ</td>
                        <td>8.7</td>
                        <td>1ê°œ</td>
                        <td>ğŸ”´ ë†’ìŒ</td>
                    </tr>
                    <tr class="complexity-medium">
                        <td><strong>UserController.java</strong></td>
                        <td>156ì¤„</td>
                        <td>15ê°œ</td>
                        <td>6.3</td>
                        <td>0ê°œ</td>
                        <td>ğŸŸ¡ ì¤‘ê°„</td>
                    </tr>
                    <tr class="complexity-medium">
                        <td><strong>ProductService.java</strong></td>
                        <td>134ì¤„</td>
                        <td>10ê°œ</td>
                        <td>5.8</td>
                        <td>1ê°œ</td>
                        <td>ğŸŸ¡ ì¤‘ê°„</td>
                    </tr>
                    <tr class="complexity-low">
                        <td><strong>UserDao.java</strong></td>
                        <td>89ì¤„</td>
                        <td>7ê°œ</td>
                        <td>3.2</td>
                        <td>0ê°œ</td>
                        <td>ğŸŸ¢ ë‚®ìŒ</td>
                    </tr>
                    <tr class="complexity-low">
                        <td><strong>CategoryService.java</strong></td>
                        <td>67ì¤„</td>
                        <td>4ê°œ</td>
                        <td>2.1</td>
                        <td>0ê°œ</td>
                        <td>ğŸŸ¢ ë‚®ìŒ</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // í’ˆì§ˆ ì§€í‘œ ë¶„í¬ ì°¨íŠ¸
        const qualityCtx = document.getElementById('qualityChart').getContext('2d');
        new Chart(qualityCtx, {
            type: 'radar',
            data: {
                labels: ['ë³µì¡ë„', 'ê°€ë…ì„±', 'ì¬ì‚¬ìš©ì„±', 'í…ŒìŠ¤íŠ¸ì„±', 'ìœ ì§€ë³´ìˆ˜ì„±'],
                datasets: [{
                    label: 'SampleSrc',
                    data: [6.8, 7.2, 8.1, 6.5, 7.8],
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    pointBackgroundColor: 'rgba(54, 162, 235, 1)'
                }, {
                    label: 'ì—…ê³„ í‰ê· ',
                    data: [7.0, 7.0, 7.0, 7.0, 7.0],
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 10
                    }
                }
            }
        });

        // ë³µì¡ë„ ë¶„í¬ ì°¨íŠ¸
        const complexityCtx = document.getElementById('complexityChart').getContext('2d');
        new Chart(complexityCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'íŒŒì¼ë³„ ë³µì¡ë„',
                    data: [
                        {x: 245, y: 9.2, label: 'ComplexQueryMapper.xml'},
                        {x: 180, y: 8.7, label: 'OrderService.java'},
                        {x: 156, y: 6.3, label: 'UserController.java'},
                        {x: 134, y: 5.8, label: 'ProductService.java'},
                        {x: 89, y: 3.2, label: 'UserDao.java'},
                        {x: 67, y: 2.1, label: 'CategoryService.java'}
                    ],
                    backgroundColor: function(context) {
                        const value = context.parsed.y;
                        if (value > 8) return '#f44336';
                        if (value > 5) return '#ff9800';
                        return '#4caf50';
                    }
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { 
                        title: { display: true, text: 'ë¼ì¸ ìˆ˜' },
                        beginAtZero: true
                    },
                    y: { 
                        title: { display: true, text: 'ë³µì¡ë„ ì ìˆ˜' },
                        beginAtZero: true
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.raw.label}: ${context.parsed.x}ì¤„, ë³µì¡ë„ ${context.parsed.y}`;
                            }
                        }
                    }
                }
            }
        });

        // D3.jsë¡œ ë³µì¡ë„ íˆíŠ¸ë§µ ìƒì„±
        const heatmapData = [
            {file: 'UserController', method: 'login', complexity: 8.5},
            {file: 'UserController', method: 'register', complexity: 6.2},
            {file: 'UserController', method: 'updateProfile', complexity: 7.1},
            {file: 'ProductService', method: 'searchProducts', complexity: 9.1},
            {file: 'ProductService', method: 'createProduct', complexity: 5.8},
            {file: 'OrderService', method: 'processOrder', complexity: 9.8},
            {file: 'OrderService', method: 'cancelOrder', complexity: 7.3}
        ];

        // íˆíŠ¸ë§µ êµ¬í˜„ (D3.js)
        const margin = {top: 20, right: 20, bottom: 60, left: 100};
        const width = 400 - margin.left - margin.right;
        const height = 300 - margin.top - margin.bottom;

        const svg = d3.select("#complexityHeatmap")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        // ìƒ‰ìƒ ìŠ¤ì¼€ì¼
        const colorScale = d3.scaleSequential(d3.interpolateRdYlGn)
            .domain([10, 0]); // ë³µì¡ë„ê°€ ë†’ì„ìˆ˜ë¡ ë¹¨ê°„ìƒ‰

        // íˆíŠ¸ë§µ ì…€ ê·¸ë¦¬ê¸°
        heatmapData.forEach((d, i) => {
            svg.append("rect")
                .attr("x", (i % 3) * 80)
                .attr("y", Math.floor(i / 3) * 40)
                .attr("width", 75)
                .attr("height", 35)
                .attr("fill", colorScale(d.complexity))
                .attr("stroke", "#fff")
                .attr("stroke-width", 2);
                
            svg.append("text")
                .attr("x", (i % 3) * 80 + 37.5)
                .attr("y", Math.floor(i / 3) * 40 + 20)
                .attr("text-anchor", "middle")
                .attr("fill", "white")
                .attr("font-size", "10px")
                .attr("font-weight", "bold")
                .text(`${d.method}\n${d.complexity}`);
        });
    </script>
</body>
</html>
