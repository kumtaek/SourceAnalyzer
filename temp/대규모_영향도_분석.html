<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SourceAnalyzer - ìŠ¤ë§ˆíŠ¸ ì˜í–¥ë„ ë¶„ì„</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; margin: 0; padding: 20px; background: #f8f9fa; }
        .header { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .analysis-setup { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .setup-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        .setup-section { background: #f8f9fa; padding: 15px; border-radius: 8px; }
        .setup-section h4 { margin-top: 0; color: #2c3e50; }
        .target-selector { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin: 5px 0; }
        .analyze-btn { background: #e74c3c; color: white; padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; }
        .analyze-btn:hover { background: #c0392b; }
        .results-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .full-width { grid-column: 1 / -1; }
        .impact-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 15px 0; }
        .impact-metric { background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center; }
        .impact-number { font-size: 2em; font-weight: bold; color: #1976d2; }
        .impact-level { padding: 10px; margin: 8px 0; border-radius: 5px; }
        .level-1 { background: #ffebee; border-left: 4px solid #f44336; }
        .level-2 { background: #fff3e0; border-left: 4px solid #ff9800; }
        .level-3 { background: #e8f5e8; border-left: 4px solid #4caf50; }
        .component-tree { max-height: 400px; overflow-y: auto; font-family: monospace; font-size: 0.9em; }
        .tree-item { padding: 5px 0; }
        .tree-level-1 { margin-left: 0px; color: #e74c3c; font-weight: bold; }
        .tree-level-2 { margin-left: 20px; color: #f39c12; }
        .tree-level-3 { margin-left: 40px; color: #2ecc71; }
        .tree-level-4 { margin-left: 60px; color: #95a5a6; }
        .impact-path { background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 5px 0; font-family: monospace; }
        .risk-assessment { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 15px 0; }
        .risk-card { padding: 15px; border-radius: 8px; text-align: center; }
        .risk-high { background: #ffebee; border: 2px solid #f44336; }
        .risk-medium { background: #fff3e0; border: 2px solid #ff9800; }
        .risk-low { background: #e8f5e8; border: 2px solid #4caf50; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¯ ìŠ¤ë§ˆíŠ¸ ì˜í–¥ë„ ë¶„ì„</h1>
        <p>ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ ëŒ€ì‘ - ì„ íƒì  ì˜í–¥ë„ ë¶„ì„ | EnterpriseApp</p>
    </div>

    <div class="analysis-setup">
        <h3>ğŸ” ë¶„ì„ ëŒ€ìƒ ì„ íƒ (ëŒ€ê·œëª¨ ë°ì´í„° ëŒ€ì‘)</h3>
        
        <div class="setup-grid">
            <div class="setup-section">
                <h4>1ï¸âƒ£ ë³€ê²½ ëŒ€ìƒ ì„ íƒ</h4>
                <select class="target-selector" id="changeType">
                    <option value="">ë³€ê²½ ìœ í˜• ì„ íƒ...</option>
                    <option value="table">ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”</option>
                    <option value="column">í…Œì´ë¸” ì»¬ëŸ¼</option>
                    <option value="api">API ì—”ë“œí¬ì¸íŠ¸</option>
                    <option value="class">Java í´ë˜ìŠ¤</option>
                    <option value="method">Java ë©”ì„œë“œ</option>
                </select>
                
                <input type="text" class="target-selector" id="targetSearch" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥ (ì˜ˆ: USERS, UserService)" onkeyup="searchTargets(this.value)">
                
                <select class="target-selector" id="targetList" size="5">
                    <option value="USERS">USERS í…Œì´ë¸” (15ê°œ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©)</option>
                    <option value="PRODUCTS">PRODUCTS í…Œì´ë¸” (12ê°œ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©)</option>
                    <option value="ORDERS">ORDERS í…Œì´ë¸” (18ê°œ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©)</option>
                    <option value="USER_PROFILES">USER_PROFILES í…Œì´ë¸” (3ê°œ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©)</option>
                    <option value="CATEGORIES">CATEGORIES í…Œì´ë¸” (7ê°œ ì¿¼ë¦¬ì—ì„œ ì‚¬ìš©)</option>
                </select>
            </div>
            
            <div class="setup-section">
                <h4>2ï¸âƒ£ ë¶„ì„ ë²”ìœ„ ì„¤ì •</h4>
                <select class="target-selector" id="analysisDepth">
                    <option value="3">3ë‹¨ê³„ (ì§ì ‘ ì˜í–¥ë§Œ)</option>
                    <option value="5" selected>5ë‹¨ê³„ (ê°„ì ‘ ì˜í–¥ í¬í•¨)</option>
                    <option value="7">7ë‹¨ê³„ (ì „ì²´ ì²´ì¸)</option>
                    <option value="all">ì œí•œ ì—†ìŒ (ì „ì²´)</option>
                </select>
                
                <select class="target-selector" id="moduleScope">
                    <option value="all">ì „ì²´ ëª¨ë“ˆ</option>
                    <option value="current">í˜„ì¬ ëª¨ë“ˆë§Œ</option>
                    <option value="related">ê´€ë ¨ ëª¨ë“ˆë§Œ</option>
                </select>
                
                <div style="margin: 10px 0;">
                    <label><input type="checkbox" checked> Frontend í¬í•¨</label><br/>
                    <label><input type="checkbox" checked> Backend í¬í•¨</label><br/>
                    <label><input type="checkbox" checked> Database í¬í•¨</label>
                </div>
            </div>
            
            <div class="setup-section">
                <h4>3ï¸âƒ£ ê²°ê³¼ í•„í„°ë§</h4>
                <select class="target-selector" id="resultLimit">
                    <option value="20">ìƒìœ„ 20ê°œë§Œ</option>
                    <option value="50" selected>ìƒìœ„ 50ê°œë§Œ</option>
                    <option value="100">ìƒìœ„ 100ê°œë§Œ</option>
                    <option value="all">ì „ì²´ ê²°ê³¼</option>
                </select>
                
                <select class="target-selector" id="riskLevel">
                    <option value="all">ì „ì²´ ìœ„í—˜ë„</option>
                    <option value="high">ë†’ì€ ìœ„í—˜ë„ë§Œ</option>
                    <option value="medium">ì¤‘ê°„ ìœ„í—˜ë„ ì´ìƒ</option>
                </select>
                
                <button class="analyze-btn" onclick="startSmartAnalysis()">ğŸš€ ìŠ¤ë§ˆíŠ¸ ë¶„ì„ ì‹œì‘</button>
            </div>
        </div>
    </div>

    <div class="results-container">
        <div class="card">
            <h3>ğŸ“Š ì˜í–¥ë„ ìš”ì•½</h3>
            
            <div class="impact-summary">
                <div class="impact-metric">
                    <div class="impact-number">47</div>
                    <div>ì§ì ‘ ì˜í–¥</div>
                </div>
                <div class="impact-metric">
                    <div class="impact-number">156</div>
                    <div>ê°„ì ‘ ì˜í–¥</div>
                </div>
                <div class="impact-metric">
                    <div class="impact-number">89</div>
                    <div>ì—°ì‡„ ì˜í–¥</div>
                </div>
                <div class="impact-metric">
                    <div class="impact-number">23</div>
                    <div>ëª¨ë“ˆ ìˆ˜</div>
                </div>
            </div>

            <div class="impact-level level-1">
                <h4>ğŸš¨ ì¦‰ì‹œ ìˆ˜ì • í•„ìš” (47ê°œ)</h4>
                <p>ì§ì ‘ì ìœ¼ë¡œ ì˜í–¥ë°›ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸ë“¤</p>
                <div style="font-size: 0.9em;">
                    â€¢ SQL ì¿¼ë¦¬: 15ê°œ<br/>
                    â€¢ Java ë©”ì„œë“œ: 18ê°œ<br/>
                    â€¢ JSP í™”ë©´: 8ê°œ<br/>
                    â€¢ API ì—”ë“œí¬ì¸íŠ¸: 6ê°œ
                </div>
            </div>

            <div class="impact-level level-2">
                <h4>âš ï¸ í…ŒìŠ¤íŠ¸ í•„ìš” (156ê°œ)</h4>
                <p>ê°„ì ‘ì ìœ¼ë¡œ ì˜í–¥ë°›ì„ ìˆ˜ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë“¤</p>
                <div style="font-size: 0.9em;">
                    â€¢ Service í´ë˜ìŠ¤: 23ê°œ<br/>
                    â€¢ Controller í´ë˜ìŠ¤: 45ê°œ<br/>
                    â€¢ DTO í´ë˜ìŠ¤: 67ê°œ<br/>
                    â€¢ Frontend ì»´í¬ë„ŒíŠ¸: 21ê°œ
                </div>
            </div>

            <div class="impact-level level-3">
                <h4>â„¹ï¸ ëª¨ë‹ˆí„°ë§ ê¶Œì¥ (89ê°œ)</h4>
                <p>ì—°ì‡„ì ìœ¼ë¡œ ì˜í–¥ë°›ì„ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë“¤</p>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ¯ ì˜í–¥ë„ ë¶„í¬</h3>
            <div class="chart-container">
                <canvas id="impactDistributionChart"></canvas>
            </div>
        </div>

        <div class="card full-width">
            <h3>ğŸŒ³ ì˜í–¥ ì „íŒŒ íŠ¸ë¦¬ (ì„ íƒì  í‘œì‹œ)</h3>
            
            <div style="margin-bottom: 15px;">
                <button onclick="expandTree('level1')" style="margin: 5px; padding: 5px 10px; border: none; background: #dc3545; color: white; border-radius: 3px; cursor: pointer;">
                    1ë‹¨ê³„ë§Œ ë³´ê¸°
                </button>
                <button onclick="expandTree('level2')" style="margin: 5px; padding: 5px 10px; border: none; background: #ffc107; color: white; border-radius: 3px; cursor: pointer;">
                    2ë‹¨ê³„ê¹Œì§€ ë³´ê¸°
                </button>
                <button onclick="expandTree('all')" style="margin: 5px; padding: 5px 10px; border: none; background: #28a745; color: white; border-radius: 3px; cursor: pointer;">
                    ì „ì²´ ë³´ê¸°
                </button>
            </div>
            
            <div class="component-tree" id="impactTree">
                <div class="tree-item tree-level-1">ğŸ“‹ USERS í…Œì´ë¸” (ë³€ê²½ ëŒ€ìƒ)</div>
                <div class="tree-item tree-level-2">  â”œâ”€â”€ ğŸ” UserMapper.xml (selectUserByUsername)</div>
                <div class="tree-item tree-level-2">  â”œâ”€â”€ ğŸ” UserMapper.xml (updateUserInfo)</div>
                <div class="tree-item tree-level-2">  â”œâ”€â”€ ğŸ” AuthMapper.xml (authenticateUser)</div>
                <div class="tree-item tree-level-3">  â”‚   â”œâ”€â”€ âš™ï¸ UserDao.findByUsername()</div>
                <div class="tree-item tree-level-3">  â”‚   â”œâ”€â”€ âš™ï¸ UserDao.updateUser()</div>
                <div class="tree-item tree-level-3">  â”‚   â””â”€â”€ âš™ï¸ AuthDao.authenticate()</div>
                <div class="tree-item tree-level-4">  â”‚       â”œâ”€â”€ ğŸ¢ UserService.authenticateUser()</div>
                <div class="tree-item tree-level-4">  â”‚       â”œâ”€â”€ ğŸ¢ UserService.updateUserProfile()</div>
                <div class="tree-item tree-level-4">  â”‚       â””â”€â”€ ğŸ¢ AuthService.login()</div>
                <div class="tree-item tree-level-4">  â”‚           â”œâ”€â”€ ğŸ® UserController.login()</div>
                <div class="tree-item tree-level-4">  â”‚           â”œâ”€â”€ ğŸ® UserController.updateProfile()</div>
                <div class="tree-item tree-level-4">  â”‚           â””â”€â”€ ğŸ® AuthController.authenticate()</div>
                <div class="tree-item tree-level-4">  â”‚               â”œâ”€â”€ ğŸŒ /api/user/login</div>
                <div class="tree-item tree-level-4">  â”‚               â”œâ”€â”€ ğŸŒ /api/user/profile</div>
                <div class="tree-item tree-level-4">  â”‚               â””â”€â”€ ğŸŒ /api/auth/login</div>
                <div class="tree-item tree-level-4">  â”‚                   â”œâ”€â”€ ğŸ–¥ï¸ login.jsp</div>
                <div class="tree-item tree-level-4">  â”‚                   â”œâ”€â”€ ğŸ–¥ï¸ userProfile.jsp</div>
                <div class="tree-item tree-level-4">  â”‚                   â”œâ”€â”€ ğŸ–¥ï¸ UserManagement.jsx</div>
                <div class="tree-item tree-level-4">  â”‚                   â””â”€â”€ ğŸ–¥ï¸ AuthComponent.jsx</div>
                <div style="margin: 10px 0; color: #95a5a6; font-style: italic;">
                    ... ì´ 292ê°œ ì»´í¬ë„ŒíŠ¸ ì¤‘ ìƒìœ„ 20ê°œë§Œ í‘œì‹œ (ë‚˜ë¨¸ì§€ëŠ” "ì „ì²´ ë³´ê¸°" í´ë¦­)
                </div>
            </div>
        </div>

        <div class="card">
            <h3>âš¡ ì˜ˆìƒ ì‘ì—… ì‹œê°„</h3>
            <div class="chart-container">
                <canvas id="workloadChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ¯ ë¦¬ìŠ¤í¬ í‰ê°€</h3>
            
            <div class="risk-assessment">
                <div class="risk-card risk-high">
                    <h4>ğŸš¨ ë†’ì€ ìœ„í—˜</h4>
                    <div style="font-size: 1.5em; font-weight: bold;">47ê°œ</div>
                    <p>ì¦‰ì‹œ ìˆ˜ì • í•„ìš”</p>
                </div>
                <div class="risk-card risk-medium">
                    <h4>âš ï¸ ì¤‘ê°„ ìœ„í—˜</h4>
                    <div style="font-size: 1.5em; font-weight: bold;">156ê°œ</div>
                    <p>í…ŒìŠ¤íŠ¸ í•„ìš”</p>
                </div>
                <div class="risk-card risk-low">
                    <h4>âœ… ë‚®ì€ ìœ„í—˜</h4>
                    <div style="font-size: 1.5em; font-weight: bold;">89ê°œ</div>
                    <p>ëª¨ë‹ˆí„°ë§ë§Œ</p>
                </div>
            </div>
            
            <h4>ğŸ“‹ í•µì‹¬ ì˜í–¥ ê²½ë¡œ (ìƒìœ„ 5ê°œë§Œ í‘œì‹œ)</h4>
            <div class="impact-path">
                <strong>ê²½ë¡œ 1:</strong> USERS â†’ UserMapper.xml â†’ UserDao â†’ UserService â†’ UserController â†’ /api/user/login â†’ login.jsp
            </div>
            <div class="impact-path">
                <strong>ê²½ë¡œ 2:</strong> USERS â†’ AuthMapper.xml â†’ AuthDao â†’ AuthService â†’ AuthController â†’ /api/auth/* â†’ ì¸ì¦ í™”ë©´ë“¤
            </div>
            <div class="impact-path">
                <strong>ê²½ë¡œ 3:</strong> USERS â†’ UserProfileMapper.xml â†’ UserDao â†’ UserService â†’ ProfileController â†’ í”„ë¡œí•„ ê´€ë ¨ í™”ë©´ë“¤
            </div>
            <div style="text-align: center; margin: 10px 0;">
                <button onclick="showAllPaths()" style="padding: 8px 15px; border: none; background: #007bff; color: white; border-radius: 3px; cursor: pointer;">
                    ì „ì²´ 292ê°œ ê²½ë¡œ ë³´ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì˜í–¥ë„ ë¶„í¬ ì°¨íŠ¸
        const impactCtx = document.getElementById('impactDistributionChart').getContext('2d');
        new Chart(impactCtx, {
            type: 'bar',
            data: {
                labels: ['ì§ì ‘ ì˜í–¥', 'ê°„ì ‘ ì˜í–¥', 'ì—°ì‡„ ì˜í–¥', 'ëª¨ë‹ˆí„°ë§'],
                datasets: [{
                    label: 'ì»´í¬ë„ŒíŠ¸ ìˆ˜',
                    data: [47, 156, 89, 23],
                    backgroundColor: ['#dc3545', '#ffc107', '#28a745', '#6c757d']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true }
                },
                onClick: function(event, elements) {
                    if (elements.length > 0) {
                        const index = elements[0].index;
                        const levels = ['ì§ì ‘', 'ê°„ì ‘', 'ì—°ì‡„', 'ëª¨ë‹ˆí„°ë§'];
                        showDetailedImpact(levels[index]);
                    }
                }
            }
        });

        // ì‘ì—… ì‹œê°„ ì˜ˆì¸¡ ì°¨íŠ¸
        const workloadCtx = document.getElementById('workloadChart').getContext('2d');
        new Chart(workloadCtx, {
            type: 'bar',
            data: {
                labels: ['ì½”ë“œ ìˆ˜ì •', 'í…ŒìŠ¤íŠ¸ ì‘ì„±', 'ë¬¸ì„œ ì—…ë°ì´íŠ¸', 'ë°°í¬ ì¤€ë¹„'],
                datasets: [{
                    label: 'ì˜ˆìƒ ì‹œê°„ (ì‹œê°„)',
                    data: [24, 16, 8, 4],
                    backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4']
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { beginAtZero: true }
                }
            }
        });

        // ëŒ€ê·œëª¨ ëŒ€ì‘ í•¨ìˆ˜ë“¤
        function searchTargets(query) {
            if (query.length > 2) {
                // ì‹¤ì‹œê°„ ê²€ìƒ‰ (ë©”íƒ€DB LIKE ì¿¼ë¦¬)
                console.log(`ê²€ìƒ‰: ${query}`);
                // ì‹¤ì œ êµ¬í˜„: SELECT * FROM components WHERE component_name LIKE '%${query}%' LIMIT 50
            }
        }

        function startSmartAnalysis() {
            const changeType = document.getElementById('changeType').value;
            const target = document.getElementById('targetList').value;
            const depth = document.getElementById('analysisDepth').value;
            
            if (!changeType || !target) {
                alert('ë³€ê²½ ìœ í˜•ê³¼ ëŒ€ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            alert(`ìŠ¤ë§ˆíŠ¸ ì˜í–¥ë„ ë¶„ì„ì„ ì‹œì‘í•©ë‹ˆë‹¤.\n\nëŒ€ìƒ: ${target}\nê¹Šì´: ${depth}ë‹¨ê³„\n\në¶„ì„ ì¤‘... (ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬)`);
            
            // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë©”íƒ€DB ì¬ê·€ ì¿¼ë¦¬ ì‹¤í–‰
            // WITH RECURSIVE impact_analysis AS (...)
        }

        function expandTree(level) {
            const tree = document.getElementById('impactTree');
            const items = tree.querySelectorAll('.tree-item');
            
            items.forEach(item => {
                if (level === 'level1') {
                    item.style.display = item.classList.contains('tree-level-1') ? 'block' : 'none';
                } else if (level === 'level2') {
                    item.style.display = (item.classList.contains('tree-level-1') || item.classList.contains('tree-level-2')) ? 'block' : 'none';
                } else {
                    item.style.display = 'block';
                }
            });
        }

        function showDetailedImpact(level) {
            alert(`${level} ì˜í–¥ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ìƒì„¸ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\nìƒˆ ì°½ì—ì„œ í•´ë‹¹ ë ˆë²¨ì˜ ìƒì„¸ ë¶„ì„ ê²°ê³¼ê°€ ì—´ë¦½ë‹ˆë‹¤.`);
        }

        function showAllPaths() {
            alert('ì „ì²´ 292ê°œ ì˜í–¥ ê²½ë¡œë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.\n\ní˜ì´ì§€ë„¤ì´ì…˜ëœ ìƒì„¸ ë·°ê°€ ì—´ë¦½ë‹ˆë‹¤.');
        }
    </script>
</body>
</html>
