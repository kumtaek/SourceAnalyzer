# JPA 테스트케이스를 위한 Spring Boot Application Properties
# 이 설정은 JPA Entity -> Repository -> Service -> Controller -> Vue 연결 구조 테스트를 위한 것입니다.

# ===============================
# 데이터베이스 설정 (Oracle)
# ===============================
spring.datasource.url=jdbc:oracle:thin:@localhost:1521:xe
spring.datasource.username=testuser
spring.datasource.password=testpass
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

# 커넥션 풀 설정
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000

# ===============================
# JPA/Hibernate 설정
# ===============================
# JPA 기본 설정
spring.jpa.database-platform=org.hibernate.dialect.Oracle12cDialect
spring.jpa.show-sql=true
spring.jpa.format-sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# DDL 설정 (개발환경에서만 사용)
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.hbm2ddl.auto=validate

# 배치 설정
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# 2차 캐시 설정
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.ehcache.EhCacheRegionFactory

# 통계 설정
spring.jpa.properties.hibernate.generate_statistics=true
spring.jpa.properties.hibernate.session.events.log.LOG_QUERIES_SLOWER_THAN_MS=1000

# ===============================
# 로깅 설정
# ===============================
# JPA/Hibernate 로그
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.org.hibernate.type.descriptor.sql.BasicExtractor=TRACE
logging.level.org.springframework.orm.jpa=DEBUG
logging.level.org.springframework.transaction=DEBUG

# 애플리케이션 로그
logging.level.com.example.jpa=DEBUG
logging.level.com.example.jpa.repository=DEBUG
logging.level.com.example.jpa.service=DEBUG
logging.level.com.example.jpa.controller=DEBUG

# SQL 로그 파일
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.file.name=logs/jpa-application.log
logging.file.max-size=10MB
logging.file.max-history=30

# ===============================
# 웹 설정
# ===============================
# 서버 포트
server.port=8080

# 컨텍스트 패스
server.servlet.context-path=/

# 세션 타임아웃 (30분)
server.servlet.session.timeout=30m

# 인코딩 설정
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# ===============================
# JSON 설정
# ===============================
# Jackson 설정
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Asia/Seoul
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.deserialization.fail-on-unknown-properties=false

# ===============================
# 트랜잭션 설정
# ===============================
# JTA 트랜잭션 매니저 비활성화 (단일 데이터소스)
spring.jta.enabled=false

# 트랜잭션 타임아웃 (30초)
spring.transaction.default-timeout=30s

# ===============================
# 프로파일 설정
# ===============================
# 활성 프로파일
spring.profiles.active=development

# ===============================
# 개발환경 설정
# ===============================
# 개발 도구 활성화
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

# 템플릿 캐시 비활성화
spring.thymeleaf.cache=false
spring.freemarker.cache=false
spring.mustache.cache=false

# ===============================
# 액추에이터 설정 (모니터링)
# ===============================
management.endpoints.web.exposure.include=health,info,metrics,prometheus,jpa
management.endpoint.health.show-details=always
management.endpoint.jpa.enabled=true
management.metrics.export.prometheus.enabled=true

# ===============================
# 커스텀 애플리케이션 설정
# ===============================
# JPA 테스트케이스 설정
app.jpa.test.enabled=true
app.jpa.test.sample-data.enabled=true
app.jpa.test.sample-data.user-count=100
app.jpa.test.sample-data.product-count=50
app.jpa.test.sample-data.order-count=200

# API 설정
app.api.version=v1
app.api.base-path=/api/jpa
app.api.cors.allowed-origins=http://localhost:3000,http://localhost:8081
app.api.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
app.api.cors.allowed-headers=*

# 페이징 기본 설정
app.pagination.default-page-size=20
app.pagination.max-page-size=100

# ===============================
# 보안 설정 (개발환경)
# ===============================
# CSRF 비활성화 (개발환경에서만)
security.csrf.enabled=false

# CORS 허용 (개발환경에서만)
security.cors.enabled=true

